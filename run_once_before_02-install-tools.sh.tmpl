#!/bin/bash

set -eufo pipefail

echo "üîß Installing development tools..."

{{ if eq .chezmoi.os "darwin" -}}
# macOS - Install via Homebrew
if ! command -v brew >/dev/null 2>&1; then
    echo "‚ùå Homebrew is not installed. Please install Homebrew first."
    exit 1
fi

# Install mise
if ! command -v mise >/dev/null 2>&1; then
    echo "üì¶ Installing mise via Homebrew..."
    brew install mise
    echo "‚úÖ mise installation completed"
else
    echo "‚è© mise is already installed"
fi

{{- else if eq .chezmoi.os "linux" -}}
# Linux - Install via official scripts

# Install mise
if ! command -v mise >/dev/null 2>&1; then
    echo "üì¶ Installing mise via official script..."
    curl https://mise.run | sh
    
    # Add mise to PATH
    echo 'export PATH="$HOME/.local/bin:$PATH"' >> ~/.bashrc
    export PATH="$HOME/.local/bin:$PATH"
else
    echo "‚úÖ mise is already installed"
fi

{{- else -}}
echo "‚ùå Unsupported OS: {{ .chezmoi.os }}"
exit 1
{{- end }}

echo "‚úÖ Development tools installation completed"